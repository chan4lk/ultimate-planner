# Ultimate Planner - Enterprise Authentication System
# Environment Configuration Template
# 
# Copy this file to .env and update with your configuration
# cp .env.example .env

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Application Settings
APP_NAME=Ultimate Planner
APP_VERSION=1.0.0
LOG_LEVEL=info

# Security Keys (CHANGE THESE IN PRODUCTION!)
SECRET_KEY=your_256_bit_secret_key_change_this_in_production_use_openssl_rand_hex_32
JWT_SECRET_KEY=your_jwt_secret_key_change_this_use_openssl_rand_hex_32
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=60

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database
DATABASE_URL=postgresql://app_user:secure_password_change_me@localhost:5432/ultimate_planner
POSTGRES_DB=ultimate_planner
POSTGRES_USER=app_user
POSTGRES_PASSWORD=secure_password_change_me
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=0
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800

# =============================================================================
# REDIS CONFIGURATION  
# =============================================================================

# Redis Connection
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Redis Pool Settings
REDIS_POOL_SIZE=20
REDIS_POOL_TIMEOUT=10

# =============================================================================
# SESSION MANAGEMENT
# =============================================================================

# Session Configuration
SESSION_EXPIRE_SECONDS=3600
REMEMBER_ME_EXPIRE_SECONDS=2592000
MAX_SESSIONS_PER_USER=5
SESSION_CLEANUP_INTERVAL=3600

# =============================================================================
# MULTI-FACTOR AUTHENTICATION (MFA)
# =============================================================================

# TOTP Configuration
TOTP_ISSUER=UltimatePlanner
TOTP_DIGITS=6
TOTP_INTERVAL=30
TOTP_WINDOW=1

# MFA Settings
MFA_BACKUP_CODES_COUNT=8
MFA_RATE_LIMIT_ATTEMPTS=10
MFA_RATE_LIMIT_WINDOW=3600

# =============================================================================
# OAUTH 2.1 PROVIDERS
# =============================================================================

# Microsoft Graph (Azure AD)
MICROSOFT_CLIENT_ID=your_microsoft_client_id
MICROSOFT_CLIENT_SECRET=your_microsoft_client_secret
MICROSOFT_TENANT=common
MICROSOFT_REDIRECT_URI=http://localhost:8000/oauth/microsoft/callback

# Google Workspace
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=http://localhost:8000/oauth/google/callback

# GitHub
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_REDIRECT_URI=http://localhost:8000/oauth/github/callback

# Notion
NOTION_CLIENT_ID=your_notion_client_id
NOTION_CLIENT_SECRET=your_notion_client_secret
NOTION_REDIRECT_URI=http://localhost:8000/oauth/notion/callback

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Login Rate Limits
LOGIN_RATE_LIMIT_REQUESTS=5
LOGIN_RATE_LIMIT_WINDOW=300
LOGIN_BLOCK_DURATION=900

# MFA Rate Limits  
MFA_RATE_LIMIT_REQUESTS=10
MFA_RATE_LIMIT_WINDOW=3600
MFA_BLOCK_DURATION=1800

# Password Reset Rate Limits
PASSWORD_RESET_RATE_LIMIT_REQUESTS=3
PASSWORD_RESET_RATE_LIMIT_WINDOW=3600
PASSWORD_RESET_BLOCK_DURATION=3600

# OAuth Rate Limits
OAUTH_RATE_LIMIT_REQUESTS=20
OAUTH_RATE_LIMIT_WINDOW=300
OAUTH_BLOCK_DURATION=300

# General Rate Limiting
RATE_LIMIT_REQUESTS=5
RATE_LIMIT_WINDOW=300
RATE_LIMIT_ENABLED=true

# =============================================================================
# AUDIT LOGGING & COMPLIANCE
# =============================================================================

# Audit Configuration
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years
AUDIT_LOG_COMPRESSION=true
AUDIT_HIGH_RISK_THRESHOLD=70
AUDIT_CRITICAL_THRESHOLD=90

# Compliance Settings
COMPLIANCE_SOC2_ENABLED=true
COMPLIANCE_GDPR_ENABLED=true
COMPLIANCE_NIST_ENABLED=true
COMPLIANCE_ISO27001_ENABLED=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://localhost:8080,https://your-frontend-domain.com
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOW_HEADERS=*

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# Encryption
FERNET_KEY=your_fernet_key_for_symmetric_encryption_use_cryptography_fernet_generate_key
PASSWORD_HASH_ROUNDS=12

# =============================================================================
# EMAIL CONFIGURATION (for notifications)
# =============================================================================

# SMTP Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_TLS=true
SMTP_SSL=false

# Email Settings
FROM_EMAIL=noreply@ultimateplanner.com
FROM_NAME=Ultimate Planner Security Team
SECURITY_NOTIFICATION_EMAIL=security@ultimateplanner.com

# =============================================================================
# MONITORING & ALERTING
# =============================================================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_OAUTH_PROVIDERS=false

# Metrics Collection
METRICS_ENABLED=true
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Logging Configuration
LOG_FORMAT=json
LOG_FILE_ENABLED=false
LOG_FILE_PATH=/app/logs/app.log
LOG_FILE_MAX_SIZE=10485760  # 10MB
LOG_FILE_BACKUP_COUNT=5

# =============================================================================
# DEVELOPMENT TOOLS (Development Environment Only)
# =============================================================================

# Redis Commander (Redis UI)
REDIS_UI_USER=admin
REDIS_UI_PASSWORD=admin

# pgAdmin (PostgreSQL UI)
PGADMIN_EMAIL=admin@ultimateplanner.com
PGADMIN_PASSWORD=admin

# Debug Settings
DEBUG_MODE=false
SQL_ECHO=false
RELOAD_ON_CHANGE=false

# =============================================================================
# PRODUCTION DEPLOYMENT
# =============================================================================

# Workers Configuration
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_TIMEOUT=120
WORKER_KEEPALIVE=5

# SSL/TLS Configuration
SSL_ENABLED=false
SSL_CERT_PATH=/etc/ssl/certs/cert.pem
SSL_KEY_PATH=/etc/ssl/private/key.pem

# Reverse Proxy Configuration
BEHIND_PROXY=false
PROXY_HEADERS=true
FORWARDED_ALLOW_IPS=127.0.0.1

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker Compose Overrides
COMPOSE_PROJECT_NAME=ultimate-planner
COMPOSE_PROFILES=development  # development, production

# Container Resource Limits
POSTGRES_MEMORY=512m
REDIS_MEMORY=256m
APP_MEMORY=1g

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Database Backup
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=us-east-1

# Redis Backup
REDIS_BACKUP_ENABLED=true
REDIS_AOF_ENABLED=true
REDIS_SAVE_INTERVAL=900

# =============================================================================
# EXTERNAL INTEGRATIONS
# =============================================================================

# Slack Notifications (Optional)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/slack/webhook
SLACK_CHANNEL=#security-alerts
SLACK_ENABLED=false

# PagerDuty Integration (Optional)
PAGERDUTY_API_KEY=your_pagerduty_api_key
PAGERDUTY_SERVICE_ID=your_service_id
PAGERDUTY_ENABLED=false

# Sentry Error Tracking (Optional)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_ENABLED=false

# =============================================================================
# NOTES
# =============================================================================

# 1. Generate secure secrets using:
#    openssl rand -hex 32
#    python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# 2. For production deployment:
#    - Change ALL default passwords
#    - Use strong, unique secrets
#    - Enable SSL/TLS
#    - Configure proper CORS origins
#    - Enable security monitoring
#
# 3. OAuth Provider Setup:
#    - Register applications with each OAuth provider
#    - Configure proper redirect URIs
#    - Ensure client secrets are kept secure
#
# 4. Compliance Requirements:
#    - Enable audit logging for SOC 2 compliance
#    - Configure GDPR data retention policies
#    - Set up security monitoring for ISO 27001
#
# 5. Monitoring Setup:
#    - Configure health checks for load balancers
#    - Set up log aggregation (ELK stack recommended)
#    - Enable real-time security alerts
#    - Configure backup verification